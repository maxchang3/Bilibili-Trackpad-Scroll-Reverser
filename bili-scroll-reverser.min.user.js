// ==UserScript==
// @name         BiliScrollReverser - 哔哩哔哩触控板滚动反转
// @namespace    http://zhangmaimai.com/
// @version      3.0.2
// @author       MaxChang3
// @description  优化 b 站视频音量调节在触控板上的体验。使用此脚本后，在 b 站视频全屏界面中，使用触控板向下滚动将减少音量。（未安装时为增大）
// @license      MIT
// @icon         https://www.bilibili.com/favicon.ico
// @match        https://www.bilibili.com/bangumi/play/*
// @match        https://www.bilibili.com/video/*
// @match        https://www.bilibili.com/list/*
// @match        https://www.bilibili.com/festival/*
// @match        https://www.bilibili.com/cheese/play/*
// @grant        GM_addStyle
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==

(function () {
	'use strict';

	const d=new Set;const e = async e=>{d.has(e)||(d.add(e),(t=>{typeof GM_addStyle=="function"?GM_addStyle(t):(document.head||document.documentElement).appendChild(document.createElement("style")).append(t);})(e));};

	e(" dialog.svelte-1p4edfu{padding:0;border:none;border-radius:16px;height:auto;max-height:90vh;width:90%;max-width:600px;overflow:auto;position:fixed;-webkit-user-select:none;user-select:none;box-shadow:0 0 10px #0000001a}dialog.svelte-1p4edfu:not([open]){display:none}dialog.svelte-1p4edfu::backdrop{background:#0009}.inner.svelte-1p4edfu{width:100%;height:auto;background:#fff;border-radius:16px}.inner.svelte-1p4edfu:focus{outline:none}@media (max-width: 768px){dialog.svelte-1p4edfu{width:95%;height:auto;max-height:95vh;border-radius:12px}.inner.svelte-1p4edfu{border-radius:12px}}main.svelte-xdgvle{--primary: #007bff;--primary-hover: #0056b3;--secondary: #6c757d;--secondary-hover: #545b62;--text: #2c3e50;--text-light: #7f8c8d;--bg-light: #f8f9fa;--border: #dee2e6;--success: #28a745;padding:20px;height:auto;font-family:system-ui,-apple-system,sans-serif;color:var(--text);line-height:1.5}.header.svelte-xdgvle{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:16px;border-bottom:2px solid #ecf0f1}h1.svelte-xdgvle{margin:0;font-size:1.5rem;font-weight:600}.content.svelte-xdgvle{text-align:center}.option-group.svelte-xdgvle{display:flex;flex-direction:column;gap:16px;margin-bottom:16px}.option-btn.svelte-xdgvle{display:flex;justify-content:space-between;align-items:center;gap:12px;padding:20px;background:#fff;border:2px solid var(--border);border-radius:12px;cursor:pointer;text-align:left}.option-btn.svelte-xdgvle:hover{background:var(--bg-light)}.option-btn.active.svelte-xdgvle{border-color:var(--primary);background:#f0f7ff}.badge.svelte-xdgvle{background:var(--primary);color:#fff;padding:4px 8px;border-radius:4px;font-size:.8rem;font-weight:600;white-space:nowrap}.btn-content.svelte-xdgvle{display:flex;flex-direction:column;gap:4px}.btn-title.svelte-xdgvle{font-weight:600;font-size:1.1rem}.btn-desc.svelte-xdgvle{color:var(--text-light);font-size:.9rem}.note.svelte-xdgvle{background:#fff3cd;color:#856404;padding:12px;border-radius:8px;font-size:.9rem;border:1px solid #ffeaa7}.instruction.svelte-xdgvle{background:#e3f2fd;color:#0c5460;padding:16px;border-radius:8px;margin-bottom:16px}.instruction.svelte-xdgvle p:where(.svelte-xdgvle){margin:0;font-size:1.1rem}.calibrate-wrapper.svelte-xdgvle{display:flex;flex-direction:column;gap:12px}.calibrate-panel.svelte-xdgvle{background:var(--bg-light);padding:16px;border-radius:12px;border:1px solid var(--border);animation:svelte-xdgvle-slideDown .2s ease-out}@keyframes svelte-xdgvle-slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.small-text.svelte-xdgvle{font-size:.85rem;color:var(--text-light);margin-top:8px}.calibrate-area.svelte-xdgvle{background:#e3f2fd;border:2px dashed #90caf9;border-radius:8px;padding:24px;display:flex;flex-direction:column;align-items:center;gap:12px;cursor:ns-resize;transition:all .2s;color:#1976d2;margin-bottom:16px}.calibrate-area.svelte-xdgvle:hover{background:#bbdefb;border-color:#64b5f6}.calibrate-icon.svelte-xdgvle{opacity:.8}.status.svelte-xdgvle{background:#fff;padding:16px;border-radius:8px;margin:16px 0;display:flex;flex-direction:column;gap:12px;border:1px solid var(--border)}.status-item.svelte-xdgvle{display:flex;justify-content:space-between;align-items:center}.label.svelte-xdgvle{font-weight:600;color:#495057}.value.svelte-xdgvle{font-family:monospace;background:#fff;padding:4px 8px;border-radius:4px;border:1px solid var(--border);font-size:1.1rem}.highlight.svelte-xdgvle{background:var(--success);color:#fff;border-color:var(--success)}.action-buttons.svelte-xdgvle{display:flex;justify-content:center;gap:12px}.btn.svelte-xdgvle{padding:12px 24px;border:none;border-radius:8px;cursor:pointer;font-weight:500;color:#fff;font-size:1rem}.btn.primary.svelte-xdgvle{background:var(--primary)}.btn.primary.svelte-xdgvle:hover:not(:disabled){background:var(--primary-hover)}.btn.secondary.svelte-xdgvle{background:var(--secondary)}.btn.secondary.svelte-xdgvle:hover{background:var(--secondary-hover)}.btn.svelte-xdgvle:disabled{opacity:.6;cursor:not-allowed;background:#dee2e6;color:#6c757d}.repo-link.svelte-xdgvle{display:flex;align-items:center;justify-content:center;opacity:.6;transition:opacity .2s}.repo-link.svelte-xdgvle:hover{opacity:1}.repo-link.svelte-xdgvle img:where(.svelte-xdgvle){border-radius:50%} ");

	var In=Array.isArray,Ln=Array.prototype.indexOf,Vn=Array.from,jn=Object.defineProperty,be=Object.getOwnPropertyDescriptor,Yn=Object.getOwnPropertyDescriptors,$n=Object.prototype,Gn=Array.prototype,Bt=Object.getPrototypeOf,Ft=Object.isExtensible;function qn(e){return e()}function at(e){for(var t=0;t<e.length;t++)e[t]();}function Ut(){var e,t,n=new Promise((r,i)=>{e=r,t=i;});return {promise:n,resolve:e,reject:t}}const E=2,ht=4,Je=8,Bn=1<<24,Z=16,J=32,ue=64,Qe=128,V=512,M=1024,N=2048,Q=4096,q=8192,ne=16384,pt=32768,me=65536,Nt=1<<17,Ht=1<<18,Se=1<<19,Wt=1<<20,ae=32768,ot=1<<21,gt=1<<22,re=1<<23,we=Symbol("$state"),ge=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Un(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Hn(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Wn(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function zn(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Kn(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Zn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Jn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Qn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Xn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function er(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const k=Symbol();function nr(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop");}function zt(e){return e===this.v}function rr(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Kt(e){return !rr(e,this.v)}let Ve=false;function sr(){Ve=true;}let w=null;function xe(e){w=e;}function yt(e,t=false,n){w={p:w,i:false,c:null,e:null,s:e,x:null,l:Ve&&!t?{s:null,u:null,$:[]}:null};}function bt(e){var t=w,n=t.e;if(n!==null){t.e=null;for(var r of n)on(r);}return e!==void 0&&(t.x=e),t.i=true,w=t.p,e??{}}function je(){return !Ve||w!==null&&w.l===null}let ye=[];function ir(){var e=ye;ye=[],at(e);}function Ye(e){if(ye.length===0){var t=ye;queueMicrotask(()=>{t===ye&&ir();});}ye.push(e);}function Zt(e){var t=g;if(t===null)return p.f|=re,e;if((t.f&pt)===0){if((t.f&Qe)===0)throw e;t.b.error(e);}else Ee(e,t);}function Ee(e,t){for(;t!==null;){if((t.f&Qe)!==0)try{t.b.error(e);return}catch(n){e=n;}t=t.parent;}throw e}const Be=new Set;let b=null,I=null,Y=[],wt=null,ut=false;class ${committed=false;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#a=null;#i=[];#s=[];skipped_effects=new Set;is_fork=false;is_deferred(){return this.is_fork||this.#n>0}process(t){Y=[],this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of t)this.#l(r,n);this.is_fork||this.#u(),this.is_deferred()?(this.#f(n.effects),this.#f(n.render_effects),this.#f(n.block_effects)):(b=null,At(n.render_effects),At(n.effects),this.#a?.resolve()),I=null;}#l(t,n){t.f^=M;for(var r=t.first;r!==null;){var i=r.f,s=(i&(J|ue))!==0,f=s&&(i&M)!==0,a=f||(i&q)!==0||this.skipped_effects.has(r);if((r.f&Qe)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!a&&r.fn!==null){s?r.f^=M:(i&ht)!==0?n.effects.push(r):Ge(r)&&((r.f&Z)!==0&&n.block_effects.push(r),Le(r));var l=r.first;if(l!==null){r=l;continue}}var o=r.parent;for(r=r.next;r===null&&o!==null;)o===n.effect&&(this.#f(n.effects),this.#f(n.render_effects),this.#f(n.block_effects),n=n.parent),r=o.next,o=o.parent;}}#f(t){for(const n of t)((n.f&N)!==0?this.#i:this.#s).push(n),this.#o(n.deps),S(n,M);}#o(t){if(t!==null)for(const n of t)(n.f&E)===0||(n.f&ae)===0||(n.f^=ae,this.#o(n.deps));}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&re)===0&&(this.current.set(t,t.v),I?.set(t,t.v));}activate(){b=this,this.apply();}deactivate(){b===this&&(b=null,I=null);}flush(){if(this.activate(),Y.length>0){if(lr(),b!==null&&b!==this)return}else this.#r===0&&this.process([]);this.deactivate();}discard(){for(const t of this.#t)t(this);this.#t.clear();}#u(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear();}this.#r===0&&this.#c();}#c(){if(Be.size>1){this.previous.clear();var t=I,n=true,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Be){if(s===this){n=false;continue}const f=[];for(const[l,o]of this.current){if(s.current.has(l))if(n&&o!==s.current.get(l))s.current.set(l,o);else continue;f.push(l);}if(f.length===0)continue;const a=[...s.current.keys()].filter(l=>!this.current.has(l));if(a.length>0){var i=Y;Y=[];const l=new Set,o=new Map;for(const c of f)Jt(c,a,l,o);if(Y.length>0){b=s,s.apply();for(const c of Y)s.#l(c,r);s.deactivate();}Y=i;}}b=null,I=t;}this.committed=true,Be.delete(this);}increment(t){this.#r+=1,t&&(this.#n+=1);}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive();}revive(){for(const t of this.#i)S(t,N),oe(t);for(const t of this.#s)S(t,Q),oe(t);this.#i=[],this.#s=[],this.flush();}oncommit(t){this.#e.add(t);}ondiscard(t){this.#t.add(t);}settled(){return (this.#a??=Ut()).promise}static ensure(){if(b===null){const t=b=new $;Be.add(b),$.enqueue(()=>{b===t&&t.flush();});}return b}static enqueue(t){Ye(t);}apply(){}}function lr(){var e=ie;ut=true;try{var n=0;for(ze(!0);Y.length>0;){var r=$.ensure();if(n++>1e3){var i,s;fr();}r.process(Y),se.clear();}}finally{ut=false,ze(e),wt=null;}}function fr(){try{Zn();}catch(e){Ee(e,wt);}}let W=null;function At(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(ne|q))===0&&Ge(r)&&(W=new Set,Le(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?_n(r):r.fn=null),W?.size>0)){se.clear();for(const i of W){if((i.f&(ne|q))!==0)continue;const s=[i];let f=i.parent;for(;f!==null;)W.has(f)&&(W.delete(f),s.push(f)),f=f.parent;for(let a=s.length-1;a>=0;a--){const l=s[a];(l.f&(ne|q))===0&&Le(l);}}W.clear();}}W=null;}}function Jt(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const i of e.reactions){const s=i.f;(s&E)!==0?Jt(i,t,n,r):(s&(gt|Z))!==0&&(s&N)===0&&Qt(i,t,r)&&(S(i,N),oe(i));}}function Qt(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const i of e.deps){if(t.includes(i))return  true;if((i.f&E)!==0&&Qt(i,t,n))return n.set(i,true),true}return n.set(e,false),false}function oe(e){for(var t=wt=e;t.parent!==null;){t=t.parent;var n=t.f;if(ut&&t===g&&(n&Z)!==0&&(n&Ht)===0)return;if((n&(ue|J))!==0){if((n&M)===0)return;t.f^=M;}}Y.push(t);}function ar(e){let t=0,n=$e(0),r;return ()=>{Pe()&&(_(n),un(()=>(t===0&&(r=Xe(()=>e(()=>Ne(n)))),t+=1,()=>{Ye(()=>{t-=1,t===0&&(r?.(),r=void 0,Ne(n));});})));}}var or=me|Se|Qe;function ur(e,t,n){new cr(e,t,n);}class cr{parent;#e=false;#t;#r=null;#n;#a;#i;#s=null;#l=null;#f=null;#o=null;#u=null;#c=0;#d=0;#_=false;#v=null;#b=ar(()=>(this.#v=$e(this.#c),()=>{this.#v=null;}));constructor(t,n,r){this.#t=t,this.#n=n,this.#a=r,this.parent=g.b,this.#e=!!this.#n.pending,this.#i=cn(()=>{g.b=this;{var i=this.#g();try{this.#s=z(()=>r(i));}catch(s){this.error(s);}this.#d>0?this.#p():this.#e=false;}return ()=>{this.#u?.remove();}},or);}#w(){try{this.#s=z(()=>this.#a(this.#t));}catch(t){this.error(t);}this.#e=false;}#m(){const t=this.#n.pending;t&&(this.#l=z(()=>t(this.#t)),$.enqueue(()=>{var n=this.#g();this.#s=this.#h(()=>($.ensure(),z(()=>this.#a(n)))),this.#d>0?this.#p():(Ae(this.#l,()=>{this.#l=null;}),this.#e=false);}));}#g(){var t=this.#t;return this.#e&&(this.#u=Oe(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return !!this.#n.pending}#h(t){var n=g,r=p,i=w;B(this.#i),D(this.#i),xe(this.#i.ctx);try{return t()}catch(s){return Zt(s),null}finally{B(n),D(r),xe(i);}}#p(){const t=this.#n.pending;this.#s!==null&&(this.#o=document.createDocumentFragment(),this.#o.append(this.#u),gn(this.#s,this.#o)),this.#l===null&&(this.#l=z(()=>t(this.#t)));}#y(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(t);return}this.#d+=t,this.#d===0&&(this.#e=false,this.#l&&Ae(this.#l,()=>{this.#l=null;}),this.#o&&(this.#t.before(this.#o),this.#o=null));}update_pending_count(t){this.#y(t),this.#c+=t,this.#v&&We(this.#v,this.#c);}get_effect_pending(){return this.#b(),_(this.#v)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#_||!n&&!r)throw t;this.#s&&(F(this.#s),this.#s=null),this.#l&&(F(this.#l),this.#l=null),this.#f&&(F(this.#f),this.#f=null);var i=false,s=false;const f=()=>{if(i){nr();return}i=true,s&&er(),$.ensure(),this.#c=0,this.#f!==null&&Ae(this.#f,()=>{this.#f=null;}),this.#e=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#_=false,z(()=>this.#a(this.#t)))),this.#d>0?this.#p():this.#e=false;};var a=p;try{D(null),s=!0,n?.(t,f),s=!1;}catch(l){Ee(l,this.#i&&this.#i.parent);}finally{D(a);}r&&Ye(()=>{this.#f=this.#h(()=>{$.ensure(),this.#_=true;try{return z(()=>{r(this.#t,()=>t,()=>f);})}catch(l){return Ee(l,this.#i.parent),null}finally{this.#_=false;}});});}}function dr(e,t,n,r){const i=je()?mt:hr;if(n.length===0&&e.length===0){r(t.map(i));return}var s=b,f=g,a=vr();function l(){Promise.all(n.map(o=>_r(o))).then(o=>{a();try{r([...t.map(i),...o]);}catch(c){(f.f&ne)===0&&Ee(c,f);}s?.deactivate(),He();}).catch(o=>{Ee(o,f);});}e.length>0?Promise.all(e).then(()=>{a();try{return l()}finally{s?.deactivate(),He();}}):l();}function vr(){var e=g,t=p,n=w,r=b;return function(s=true){B(e),D(t),xe(n),s&&r?.activate();}}function He(){B(null),D(null),xe(null);}function mt(e){var t=E|N,n=p!==null&&(p.f&E)!==0?p:null;return g!==null&&(g.f|=Se),{ctx:w,deps:null,effects:null,equals:zt,f:t,fn:e,reactions:null,rv:0,v:k,wv:0,parent:n??g,ac:null}}function _r(e,t){let n=g;n===null&&Hn();var r=n.b,i=void 0,s=$e(k),f=!p,a=new Map;return kr(()=>{var l=Ut();i=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{o===b&&o.committed&&o.deactivate(),He();});}catch(u){l.reject(u),He();}var o=b;if(f){var c=!r.is_pending();r.update_pending_count(1),o.increment(c),a.get(o)?.reject(ge),a.delete(o),a.set(o,l);}const v=(u,d=void 0)=>{if(o.activate(),d)d!==ge&&(s.f|=re,We(s,d));else {(s.f&re)!==0&&(s.f^=re),We(s,u);for(const[h,x]of a){if(a.delete(h),h===o)break;x.reject(ge);}}f&&(r.update_pending_count(-1),o.decrement(c));};l.promise.then(v,u=>v(null,u||"unknown"));}),Mt(()=>{for(const l of a.values())l.reject(ge);}),new Promise(l=>{function o(c){function v(){c===i?l(s):o(i);}c.then(v,v);}o(i);})}function hr(e){const t=mt(e);return t.equals=Kt,t}function Xt(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)F(t[n]);}}function pr(e){for(var t=e.parent;t!==null;){if((t.f&E)===0)return (t.f&ne)===0?t:null;t=t.parent;}return null}function xt(e){var t,n=g;B(pr(e));try{e.f&=~ae,Xt(e),t=mn(e);}finally{B(n);}return t}function en(e){var t=xt(e);if(e.equals(t)||(b?.is_fork||(e.v=t),e.wv=bn()),!Te)if(I!==null)(Pe()||b?.is_fork)&&I.set(e,t);else {var n=(e.f&V)===0?Q:M;S(e,n);}}let ct=new Set;const se=new Map;let tn=false;function $e(e,t){var n={f:0,v:e,reactions:null,equals:zt,rv:0,wv:0};return n}function te(e,t){const n=$e(e);return Dr(n),n}function pe(e,t=false,n=true){const r=$e(e);return t||(r.equals=Kt),Ve&&n&&w!==null&&w.l!==null&&(w.l.s??=[]).push(r),r}function y(e,t,n=false){p!==null&&(!G||(p.f&Nt)!==0)&&je()&&(p.f&(E|Z|gt|Nt))!==0&&!K?.includes(e)&&Xn();let r=n?Ce(t):t;return We(e,r)}function We(e,t){if(!e.equals(t)){var n=e.v;Te?se.set(e,t):se.set(e,n),e.v=t;var r=$.ensure();r.capture(e,n),(e.f&E)!==0&&((e.f&N)!==0&&xt(e),S(e,(e.f&V)!==0?M:Q)),e.wv=bn(),nn(e,N),je()&&g!==null&&(g.f&M)!==0&&(g.f&(J|ue))===0&&(P===null?Cr([e]):P.push(e)),!r.is_fork&&ct.size>0&&!tn&&gr();}return t}function gr(){tn=false;var e=ie;ze(true);const t=Array.from(ct);try{for(const n of t)(n.f&M)!==0&&S(n,Q),Ge(n)&&Le(n);}finally{ze(e);}ct.clear();}function Ne(e){y(e,e.v+1);}function nn(e,t){var n=e.reactions;if(n!==null)for(var r=je(),i=n.length,s=0;s<i;s++){var f=n[s],a=f.f;if(!(!r&&f===g)){var l=(a&N)===0;if(l&&S(f,t),(a&E)!==0){var o=f;I?.delete(o),(a&ae)===0&&(a&V&&(f.f|=ae),nn(o,Q));}else l&&((a&Z)!==0&&W!==null&&W.add(f),oe(f));}}}function Ce(e){if(typeof e!="object"||e===null||we in e)return e;const t=Bt(e);if(t!==$n&&t!==Gn)return e;var n=new Map,r=In(e),i=te(0),s=fe,f=a=>{if(fe===s)return a();var l=p,o=fe;D(null),It(s);var c=a();return D(l),It(o),c};return r&&n.set("length",te(e.length)),new Proxy(e,{defineProperty(a,l,o){(!("value"in o)||o.configurable===false||o.enumerable===false||o.writable===false)&&Jn();var c=n.get(l);return c===void 0?c=f(()=>{var v=te(o.value);return n.set(l,v),v}):y(c,o.value,true),true},deleteProperty(a,l){var o=n.get(l);if(o===void 0){if(l in a){const c=f(()=>te(k));n.set(l,c),Ne(i);}}else y(o,k),Ne(i);return  true},get(a,l,o){if(l===we)return e;var c=n.get(l),v=l in a;if(c===void 0&&(!v||be(a,l)?.writable)&&(c=f(()=>{var d=Ce(v?a[l]:k),h=te(d);return h}),n.set(l,c)),c!==void 0){var u=_(c);return u===k?void 0:u}return Reflect.get(a,l,o)},getOwnPropertyDescriptor(a,l){var o=Reflect.getOwnPropertyDescriptor(a,l);if(o&&"value"in o){var c=n.get(l);c&&(o.value=_(c));}else if(o===void 0){var v=n.get(l),u=v?.v;if(v!==void 0&&u!==k)return {enumerable:true,configurable:true,value:u,writable:true}}return o},has(a,l){if(l===we)return  true;var o=n.get(l),c=o!==void 0&&o.v!==k||Reflect.has(a,l);if(o!==void 0||g!==null&&(!c||be(a,l)?.writable)){o===void 0&&(o=f(()=>{var u=c?Ce(a[l]):k,d=te(u);return d}),n.set(l,o));var v=_(o);if(v===k)return  false}return c},set(a,l,o,c){var v=n.get(l),u=l in a;if(r&&l==="length")for(var d=o;d<v.v;d+=1){var h=n.get(d+"");h!==void 0?y(h,k):d in a&&(h=f(()=>te(k)),n.set(d+"",h));}if(v===void 0)(!u||be(a,l)?.writable)&&(v=f(()=>te(void 0)),y(v,Ce(o)),n.set(l,v));else {u=v.v!==k;var x=f(()=>Ce(o));y(v,x);}var j=Reflect.getOwnPropertyDescriptor(a,l);if(j?.set&&j.set.call(c,o),!u){if(r&&typeof l=="string"){var qe=n.get("length"),Re=Number(l);Number.isInteger(Re)&&Re>=qe.v&&y(qe,Re+1);}Ne(i);}return  true},ownKeys(a){_(i);var l=Reflect.ownKeys(a).filter(v=>{var u=n.get(v);return u===void 0||u.v!==k});for(var[o,c]of n)c.v!==k&&!(o in a)&&l.push(o);return l},setPrototypeOf(){Qn();}})}var Ot,rn,sn,ln;function yr(){if(Ot===void 0){Ot=window,rn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;sn=be(t,"firstChild").get,ln=be(t,"nextSibling").get,Ft(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Ft(n)&&(n.__t=void 0);}}function Oe(e=""){return document.createTextNode(e)}function fn(e){return sn.call(e)}function Et(e){return ln.call(e)}function m(e,t){return fn(e)}function R(e,t=1,n=false){let r=e;for(;t--;)r=Et(r);return r}function br(){return  false}function kt(e){var t=p,n=g;D(null),B(null);try{return e()}finally{D(t),B(n);}}function an(e){g===null&&(p===null&&Kn(),zn()),Te&&Wn();}function wr(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e);}function U(e,t,n){var r=g;r!==null&&(r.f&q)!==0&&(e|=q);var i={ctx:w,deps:null,nodes_start:null,nodes_end:null,f:e|N|V,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Le(i),i.f|=pt;}catch(a){throw F(i),a}else t!==null&&oe(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&Se)===0&&(s=s.first,(e&Z)!==0&&(e&me)!==0&&s!==null&&(s.f|=me)),s!==null&&(s.parent=r,r!==null&&wr(s,r),p!==null&&(p.f&E)!==0&&(e&ue)===0)){var f=p;(f.effects??=[]).push(s);}return i}function Pe(){return p!==null&&!G}function Mt(e){const t=U(Je,null,false);return S(t,M),t.teardown=e,t}function dt(e){an();var t=g.f,n=!p&&(t&J)!==0&&(t&pt)===0;if(n){var r=w;(r.e??=[]).push(e);}else return on(e)}function on(e){return U(ht|Wt,e,false)}function mr(e){return an(),U(Je|Wt,e,true)}function xr(e){$.ensure();const t=U(ue|Se,e,true);return (n={})=>new Promise(r=>{n.outro?Ae(t,()=>{F(t),r(void 0);}):(F(t),r(void 0));})}function Er(e){return U(ht,e,false)}function kr(e){return U(gt|Se,e,true)}function un(e,t=0){return U(Je|t,e,true)}function Ue(e,t=[],n=[],r=[]){dr(r,t,n,i=>{U(Je,()=>e(...i.map(_)),!0);});}function cn(e,t=0){var n=U(Z|t,e,true);return n}function z(e){return U(J|Se,e,true)}function dn(e){var t=e.teardown;if(t!==null){const n=Te,r=p;Pt(true),D(null);try{t.call(null);}finally{Pt(n),D(r);}}}function vn(e,t=false){var n=e.first;for(e.first=e.last=null;n!==null;){const i=n.ac;i!==null&&kt(()=>{i.abort(ge);});var r=n.next;(n.f&ue)!==0?n.parent=null:F(n,t),n=r;}}function Mr(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&J)===0&&F(t),t=n;}}function F(e,t=true){var n=false;(t||(e.f&Ht)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Sr(e.nodes_start,e.nodes_end),n=true),vn(e,t&&!n),Ke(e,0),S(e,ne);var r=e.transitions;if(r!==null)for(const s of r)s.stop();dn(e);var i=e.parent;i!==null&&i.first!==null&&_n(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null;}function Sr(e,t){for(;e!==null;){var n=e===t?null:Et(e);e.remove(),e=n;}}function _n(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n));}function Ae(e,t,n=true){var r=[];hn(e,r,true),Tr(r,()=>{n&&F(e),t&&t();});}function Tr(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r);}else t();}function hn(e,t,n){if((e.f&q)===0){if(e.f^=q,e.transitions!==null)for(const f of e.transitions)(f.is_global||n)&&t.push(f);for(var r=e.first;r!==null;){var i=r.next,s=(r.f&me)!==0||(r.f&J)!==0&&(e.f&Z)!==0;hn(r,t,s?n:false),r=i;}}}function Rr(e){pn(e,true);}function pn(e,t){if((e.f&q)!==0){e.f^=q,(e.f&M)===0&&(S(e,N),oe(e));for(var n=e.first;n!==null;){var r=n.next,i=(n.f&me)!==0||(n.f&J)!==0;pn(n,i?t:false),n=r;}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in();}}function gn(e,t){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var i=n===r?null:Et(n);t.append(n),n=i;}}let ie=false;function ze(e){ie=e;}let Te=false;function Pt(e){Te=e;}let p=null,G=false;function D(e){p=e;}let g=null;function B(e){g=e;}let K=null;function Dr(e){p!==null&&(K===null?K=[e]:K.push(e));}let T=null,C=0,P=null;function Cr(e){P=e;}let yn=1,Ie=0,fe=Ie;function It(e){fe=e;}function bn(){return ++yn}function Ge(e){var t=e.f;if((t&N)!==0)return  true;if(t&E&&(e.f&=~ae),(t&Q)!==0){var n=e.deps;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i];if(Ge(s)&&en(s),s.wv>e.wv)return  true}(t&V)!==0&&I===null&&S(e,M);}return  false}function wn(e,t,n=true){var r=e.reactions;if(r!==null&&!K?.includes(e))for(var i=0;i<r.length;i++){var s=r[i];(s.f&E)!==0?wn(s,t,false):t===s&&(n?S(s,N):(s.f&M)!==0&&S(s,Q),oe(s));}}function mn(e){var t=T,n=C,r=P,i=p,s=K,f=w,a=G,l=fe,o=e.f;T=null,C=0,P=null,p=(o&(J|ue))===0?e:null,K=null,xe(e.ctx),G=false,fe=++Ie,e.ac!==null&&(kt(()=>{e.ac.abort(ge);}),e.ac=null);try{e.f|=ot;var c=e.fn,v=c(),u=e.deps;if(T!==null){var d;if(Ke(e,C),u!==null&&C>0)for(u.length=C+T.length,d=0;d<T.length;d++)u[C+d]=T[d];else e.deps=u=T;if(ie&&Pe()&&(e.f&V)!==0)for(d=C;d<u.length;d++)(u[d].reactions??=[]).push(e);}else u!==null&&C<u.length&&(Ke(e,C),u.length=C);if(je()&&P!==null&&!G&&u!==null&&(e.f&(E|Q|N))===0)for(d=0;d<P.length;d++)wn(P[d],e);return i!==null&&i!==e&&(Ie++,P!==null&&(r===null?r=P:r.push(...P))),(e.f&re)!==0&&(e.f^=re),v}catch(h){return Zt(h)}finally{e.f^=ot,T=t,C=n,P=r,p=i,K=s,xe(f),G=a,fe=l;}}function Fr(e,t){let n=t.reactions;if(n!==null){var r=Ln.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop());}}n===null&&(t.f&E)!==0&&(T===null||!T.includes(t))&&(S(t,Q),(t.f&V)!==0&&(t.f^=V,t.f&=~ae),Xt(t),Ke(t,0));}function Ke(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Fr(e,n[r]);}function Le(e){var t=e.f;if((t&ne)===0){S(e,M);var n=g,r=ie;g=e,ie=true;try{(t&(Z|Bn))!==0?Mr(e):vn(e),dn(e);var i=mn(e);e.teardown=typeof i=="function"?i:null,e.wv=yn;var s;}finally{ie=r,g=n;}}}function _(e){var t=e.f,n=(t&E)!==0;if(p!==null&&!G){var r=g!==null&&(g.f&ne)!==0;if(!r&&!K?.includes(e)){var i=p.deps;if((p.f&ot)!==0)e.rv<Ie&&(e.rv=Ie,T===null&&i!==null&&i[C]===e?C++:T===null?T=[e]:T.includes(e)||T.push(e));else {(p.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[p]:s.includes(p)||s.push(p);}}}if(Te){if(se.has(e))return se.get(e);if(n){var f=e,a=f.v;return ((f.f&M)===0&&f.reactions!==null||En(f))&&(a=xt(f)),se.set(f,a),a}}else n&&(!I?.has(e)||b?.is_fork&&!Pe())&&(f=e,Ge(f)&&en(f),ie&&Pe()&&(f.f&V)===0&&xn(f));if(I?.has(e))return I.get(e);if((e.f&re)!==0)throw e.v;return e.v}function xn(e){if(e.deps!==null){e.f^=V;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&E)!==0&&(t.f&V)===0&&xn(t);}}function En(e){if(e.v===k)return  true;if(e.deps===null)return  false;for(const t of e.deps)if(se.has(t)||(t.f&E)!==0&&En(t))return  true;return  false}function Xe(e){var t=G;try{return G=!0,e()}finally{G=t;}}const Nr=-7169;function S(e,t){e.f=e.f&Nr|t;}function Ar(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(we in e)vt(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&we in n&&vt(n);}}}function vt(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{vt(e[r],t);}catch{}const n=Bt(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Yn(n);for(let i in r){const s=r[i].get;if(s)try{s.call(e);}catch{}}}}}const Or=["touchstart","touchmove"];function Pr(e){return Or.includes(e)}const Ir=new Set,Lt=new Set;function Lr(e,t,n,r={}){function i(s){if(r.capture||Fe.call(t,s),!s.cancelBubble)return kt(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Ye(()=>{t.addEventListener(e,i,r);}):t.addEventListener(e,i,r),i}function ve(e,t,n,r,i){var s={capture:r,passive:i},f=Lr(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Mt(()=>{t.removeEventListener(e,f,s);});}let Vt=null;function Fe(e){var t=this,n=t.ownerDocument,r=e.type,i=e.composedPath?.()||[],s=i[0]||e.target;Vt=e;var f=0,a=Vt===e&&e.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var o=i.indexOf(t);if(o===-1)return;l<=o&&(f=l);}if(s=i[f]||e.target,s!==t){jn(e,"currentTarget",{configurable:true,get(){return s||n}});var c=p,v=g;D(null),B(null);try{for(var u,d=[];s!==null;){var h=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+r];x!=null&&(!s.disabled||e.target===s)&&x.call(s,e);}catch(j){u?d.push(j):u=j;}if(e.cancelBubble||h===t||h===null)break;s=h;}if(u){for(let j of d)queueMicrotask(()=>{throw j});throw u}}finally{e.__root=t,delete e.currentTarget,D(c),B(v);}}}function Vr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function kn(e,t){var n=g;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t);}function ce(e,t){var r,i=!e.startsWith("<!>");return ()=>{r===void 0&&(r=Vr(i?e:"<!>"+e),r=fn(r));var s=rn?document.importNode(r,true):r.cloneNode(true);return kn(s,s),s}}function jt(e=""){{var t=Oe(e+"");return kn(t,t),t}}function H(e,t){e!==null&&e.before(t);}function rt(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"");}function Mn(e,t){return jr(e,t)}const _e=new Map;function jr(e,{target:t,anchor:n,props:r={},events:i,context:s,intro:f=true}){yr();var a=new Set,l=v=>{for(var u=0;u<v.length;u++){var d=v[u];if(!a.has(d)){a.add(d);var h=Pr(d);t.addEventListener(d,Fe,{passive:h});var x=_e.get(d);x===void 0?(document.addEventListener(d,Fe,{passive:h}),_e.set(d,1)):_e.set(d,x+1);}}};l(Vn(Ir)),Lt.add(l);var o=void 0,c=xr(()=>{var v=n??t.appendChild(Oe());return ur(v,{pending:()=>{}},u=>{if(s){yt({});var d=w;d.c=s;}i&&(r.$$events=i),o=e(u,r)||{},s&&bt();}),()=>{for(var u of a){t.removeEventListener(u,Fe);var d=_e.get(u);--d===0?(document.removeEventListener(u,Fe),_e.delete(u)):_e.set(u,d);}Lt.delete(l),v!==n&&v.parentNode?.removeChild(v);}});return Yr.set(o,c),o}let Yr=new WeakMap;class $r{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#a=true;constructor(t,n=true){this.anchor=t,this.#a=n;}#i=()=>{var t=b;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Rr(r),this.#n.delete(n);else {var i=this.#r.get(n);i&&(this.#t.set(n,i.effect),this.#r.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect);}for(const[s,f]of this.#e){if(this.#e.delete(s),s===t)break;const a=this.#r.get(f);a&&(F(a.effect),this.#r.delete(f));}for(const[s,f]of this.#t){if(s===n||this.#n.has(s))continue;const a=()=>{if(Array.from(this.#e.values()).includes(s)){var o=document.createDocumentFragment();gn(f,o),o.append(Oe()),this.#r.set(s,{effect:f,fragment:o});}else F(f);this.#n.delete(s),this.#t.delete(s);};this.#a||!r?(this.#n.add(s),Ae(f,a,false)):a();}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,i]of this.#r)n.includes(r)||(F(i.effect),this.#r.delete(r));};ensure(t,n){var r=b,i=br();if(n&&!this.#t.has(t)&&!this.#r.has(t))this.#t.set(t,z(()=>n(this.anchor)));if(this.#e.set(r,t),i);else this.#i();}}function he(e,t,n=false){var r=new $r(e),i=n?me:0;function s(f,a){r.ensure(f,a);}cn(()=>{var f=false;t((a,l=true)=>{f=true,s(l,a);}),f||s(false,null);},i);}function Gr(e,t,n,r,i){var s=t.$$slots?.[n],f=false;s===true&&(s=t.children,f=true),s===void 0||s(e,f?()=>r:r);}function qr(e,t,n){var r=e==null?"":""+e;return r=r?r+" "+t:t,r===""?null:r}function Yt(e,t,n,r,i,s){var f=e.__className;if(f!==n||f===void 0){var a=qr(n,r);a==null?e.removeAttribute("class"):e.className=a,e.__className=n;}return s}function _t(e,t,n){var r=be(e,t);r&&r.set&&(e[t]=n,Mt(()=>{e[t]=null;}));}function $t(e,t){return e===t||e?.[we]===t}function Sn(e={},t,n,r){return Er(()=>{var i,s;return un(()=>{i=s,s=[],Xe(()=>{e!==n(...s)&&(t(e,...s),i&&$t(n(...i),e)&&t(null,...i));});}),()=>{Ye(()=>{s&&$t(n(...s),e)&&t(null,...s);});}}),e}function st(e){return function(...t){var n=t[0];return n.stopPropagation(),e?.apply(this,t)}}function Tn(e=false){const t=w,n=t.l.u;if(!n)return;let r=()=>Ar(t.s);if(e){let i=0,s={};const f=mt(()=>{let a=false;const l=t.s;for(const o in l)l[o]!==s[o]&&(s[o]=l[o],a=true);return a&&i++,i});r=()=>_(f);}n.b.length&&mr(()=>{Gt(t,r),at(n.b);}),dt(()=>{const i=Xe(()=>n.m.map(qn));return ()=>{for(const s of i)typeof s=="function"&&s();}}),n.a.length&&dt(()=>{Gt(t,r),at(n.a);});}function Gt(e,t){if(e.l.s)for(const n of e.l.s)_(n);t();}function Br(e){w===null&&Un(),Ve&&w.l!==null?Ur(w).m.push(e):dt(()=>{const t=Xe(e);if(typeof t=="function")return t});}function Ur(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Hr="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Hr);sr();var Wr=typeof GM_getValue<"u"?GM_getValue:void 0,zr=typeof GM_info<"u"?GM_info:void 0,Kr=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,Zr=typeof GM_setValue<"u"?GM_setValue:void 0;const Ze=()=>Wr("MOUSE_MIN",void 0),Jr=e=>Zr("MOUSE_MIN",e),{name:Qr,version:Xr}=zr.script,qt=(e,t,...n)=>{const r={log:"#2c3e50",error:"#ff4500"},i="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;";console[e](`%c ${Qr} %c v${Xr} %c ${t} `,`padding: 2px 6px; border-radius: 3px 0 0 3px; color: #fff; background: #FF6699; font-weight: bold; ${i}`,`padding: 2px 6px; color: #fff; background: #FF9999; font-weight: bold; ${i}`,`padding: 2px 6px; border-radius: 0 3px 3px 0; color: #fff; background: ${r[e]}; font-weight: bold; ${i}`,...n);},ke={log:(...e)=>qt("log","日志",...e),error:(...e)=>qt("error","错误",...e)};let Me=Ze()||-1,it;ke.log(Me===-1?"简单模式":"校准模式");ke.log(`阈值: ${Me}`);const es=e=>{Me=e??-1,ke.log(`更新阈值: ${Me}`);},ts=()=>(it||(it=player.getElements().container),!!document.fullscreenElement||it.dataset.screen==="web"),ns=e=>Me===-1?Math.abs(e.deltaY)<100:Math.abs(e.deltaY)!==Me&&Number.isInteger(e.deltaY*2);var rs=ce('<div><dialog class="svelte-1p4edfu"><div class="inner svelte-1p4edfu"><!></div></dialog></div>');function ss(e,t){yt(t,false);let n=pe();const r=()=>{_(n).showModal(),document.body.style.overflow="hidden";},i=()=>{_(n).close(),document.body.style.overflow="";};Br(()=>{r();const c=u=>{u.key==="Escape"&&(u.preventDefault(),i());};_(n).addEventListener("keydown",c);const v=u=>{u.target===_(n)&&i();};return _(n).addEventListener("click",v),()=>{_(n)?.removeEventListener("keydown",c),_(n)?.removeEventListener("click",v);}});var s={showModal:r,closeModal:i};Tn();var f=rs(),a=m(f),l=m(a),o=m(l);return Gr(o,t,"default",{}),Sn(a,c=>y(n,c),()=>_(n)),H(e,f),_t(t,"showModal",r),_t(t,"closeModal",i),bt(s)}var is=ce('<span class="badge svelte-xdgvle">已启用</span>'),ls=ce('<button><div class="btn-content svelte-xdgvle"><span class="btn-title svelte-xdgvle">简单模式</span> <span class="btn-desc svelte-xdgvle">默认 deltaY &lt; 100 为触控板</span></div> <!></button>'),fs=ce('<span class="badge svelte-xdgvle">已启用</span>'),as=ce('<button><div class="btn-content svelte-xdgvle"><span class="btn-title svelte-xdgvle">校验模式</span> <span class="btn-desc svelte-xdgvle"><!></span></div> <!></button>'),os=ce('<div class="calibrate-panel svelte-xdgvle"><div class="instruction svelte-xdgvle"><p class="svelte-xdgvle">请使用<strong>最小刻度</strong>滚动<strong>鼠标滚轮</strong></p> <p class="small-text svelte-xdgvle">请不要快速连续滚动，优先选择大多数情况下出现的最小整数值。</p></div> <div class="calibrate-area svelte-xdgvle"><div class="calibrate-icon svelte-xdgvle"><svg viewBox="0 0 24 24" width="32" height="32" fill="currentColor"><path d="M12 2C8.69 2 6 4.69 6 8v8c0 3.31 2.69 6 6 6s6-2.69 6-6V8c0-3.31-2.69-6-6-6zm0 2c2.21 0 4 1.79 4 4v8c0 2.21-1.79 4-4 4s-4-1.79-4-4V8c0-2.21 1.79-4 4-4zm-1 2v4h2V6h-2z"></path></svg></div> <span>在此区域滚动鼠标滚轮</span></div> <div class="status svelte-xdgvle"><div class="status-item svelte-xdgvle"><span class="label svelte-xdgvle">最小 deltaY 绝对值:</span> <span class="value highlight svelte-xdgvle"> </span></div> <div class="status-item svelte-xdgvle"><span class="label svelte-xdgvle">当前值:</span> <span class="value svelte-xdgvle"> </span></div></div> <div class="action-buttons svelte-xdgvle"><button class="btn secondary svelte-xdgvle">取消</button> <button class="btn secondary svelte-xdgvle">重置</button> <button class="btn primary svelte-xdgvle">确定</button></div></div>'),us=ce('<main class="svelte-xdgvle"><div class="header svelte-xdgvle"><h1 class="svelte-xdgvle">BiliScrollReverser</h1> <a href="https://github.com/maxchang3/BiliScrollReverser" target="_blank" rel="noopener noreferrer" class="repo-link svelte-xdgvle" title="Github"><img src="https://github.com/favicon.ico" alt="GitHub" width="24" height="24" class="svelte-xdgvle"/></a></div> <div class="content svelte-xdgvle"><div class="option-group svelte-xdgvle"><!> <div class="calibrate-wrapper svelte-xdgvle"><!> <!></div></div> <div class="note svelte-xdgvle"><strong>注意：</strong>如果鼠标滚动均为整数值，建议选择简单模式</div></div></main>');function Rn(e,t){yt(t,false);let n=pe(false),r=pe(1/0),i=pe(),s=pe(),f=pe(Ze());player.on("Player_Canplay",()=>player.pause());const a=()=>{y(f,Ze()),y(n,false),y(r,1/0),_(s).showModal();},l=h=>{if(h===1/0){y(r,1/0);return}Jr(h),es(h),y(f,h),y(n,false);},o=()=>{y(n,true),y(r,1/0),y(i,0);},c=()=>{y(n,false),y(r,1/0);},v=h=>{if(h.preventDefault(),h.stopPropagation(),!_(n))return;const x=h;x.deltaY!==0&&Math.abs(x.deltaY)<_(r)&&y(r,Math.abs(x.deltaY)),y(i,x.deltaY);},u=(h,x="未设置")=>h!==void 0&&h!==1/0?h:x;var d={show:a};return Tn(),Sn(ss(e,{children:(h,x)=>{var j=us(),qe=R(m(j),2),Re=m(qe),St=m(Re);{var Dn=L=>{var A=ls(),le=R(m(A),2);{var de=X=>{var De=is();H(X,De);};he(le,X=>{_(f)===-1&&X(de);});}Ue(()=>Yt(A,1,`option-btn ${_(f)===-1?"active":""}`,"svelte-xdgvle")),ve("click",A,()=>{l(-1),y(n,false);}),H(L,A);};he(St,L=>{_(n)||L(Dn);});}var Cn=R(St,2),Tt=m(Cn);{var Fn=L=>{var A=as(),le=m(A),de=R(m(le),2),X=m(de);{var De=O=>{var ee=jt();Ue(()=>rt(ee,`当前阈值: ${_(f)??""} (点击重新校验)`)),H(O,ee);},et=O=>{var ee=jt("根据鼠标滚轮校准检测阈值");H(O,ee);};he(X,O=>{_(f)!==void 0&&_(f)!==-1?O(De):O(et,false);});}var tt=R(le,2);{var nt=O=>{var ee=fs();H(O,ee);};he(tt,O=>{_(f)!==void 0&&_(f)!==-1&&O(nt);});}Ue(()=>Yt(A,1,`option-btn ${_(f)!==void 0&&_(f)!==-1||_(n)?"active":""}`,"svelte-xdgvle")),ve("click",A,o),H(L,A);};he(Tt,L=>{_(n)||L(Fn);});}var Nn=R(Tt,2);{var An=L=>{var A=os(),le=R(m(A),2),de=R(le,2),X=m(de),De=R(m(X),2),et=m(De),tt=R(X,2),nt=R(m(tt),2),O=m(nt),ee=R(de,2),Rt=m(ee),Dt=R(Rt,2),Ct=R(Dt,2);Ue((On,Pn)=>{rt(et,On),rt(O,Pn),Ct.disabled=_(r)===1/0;},[()=>u(_(r)),()=>u(_(i))]),ve("wheel",le,v),ve("click",Rt,st(c)),ve("click",Dt,st(()=>y(r,1/0))),ve("click",Ct,st(()=>l(_(r)))),H(L,A);};he(Nn,L=>{_(n)&&L(An);});}H(h,j);},$$slots:{default:true},$$legacy:true}),h=>y(s,h),()=>_(s)),_t(t,"show",a),bt(d)}const cs=EventTarget.prototype.addEventListener,ds=(e,t,n)=>{const[r,i,...s]=n;return t instanceof HTMLElement||!(i instanceof Function)||r!=="mousewheel"&&r!=="wheel"?Reflect.apply(e,t,n):Reflect.apply(e,t,[r,a=>{try{if(!ts()||!ns(a))return Reflect.apply(i,t,[a]);const l=new Proxy(a,{get:(o,c)=>typeof c=="symbol"||c!=="wheelDelta"?Reflect.get(o,c):Reflect.get(o,"deltaY")*10});return Reflect.apply(i,t,[l])}catch(l){return ke.error("Wheel 事件处理失败:",l),Reflect.apply(i,t,[a])}},...s])},vs=()=>{try{EventTarget.prototype.addEventListener=new Proxy(cs,{apply:ds}),ke.log("Hook 成功");}catch(e){ke.error("Hook 失败:",e);}};let lt=null,ft=null;const _s=()=>{Kr("配置",()=>{if(lt){lt.show();return}document.body.style.overflow="hidden",ft=document.createElement("div"),document.body.append(ft),lt=Mn(Rn,{target:ft});});};vs();_s();Ze()===void 0&&(window.onload=()=>{document.body.style.overflow="hidden",Mn(Rn,{target:(()=>{const e=document.createElement("div");return document.body.append(e),e})()});});

})();